# 実装計画

- [x] 1. プロジェクト構造とコア設定の初期化




  - [x] 1.1 プロジェクト基盤の初期化






    - .gitignoreファイルの作成（Node.js、AWS、IDE設定、SvelteKit、Terraformを除外）
    - package.jsonの作成と基本設定
    - 初期プロジェクト構造の作成
    - _要件: 10.1, 10.2_

  - [x] 1.2 SvelteKitプロジェクトの構築





    - SvelteKitプロジェクトの作成とTypeScript設定
    - AWS SDK、Milkdown、必要な依存関係のインストール
    - プロジェクト構造の作成（components、services、stores、types）
    - 基本的な型定義ファイルの作成
    - _要件: 1.1, 2.2, 4.1_

- [x] 2. 基本型定義とインターフェースの実装





  - [x] 2.1 コア型定義の作成


    - User、UserRole、WikiPage、PageMetadata型の定義
    - AuthResult、SaveResult、FileInfo型の定義
    - WikiConfig、PageNode型の定義
    - _要件: 2.2, 2.3, 3.1, 7.1_

  - [x] 2.2 サービスインターフェースの定義


    - AuthService、S3Service、WikiService、FileServiceインターフェース
    - エラーハンドリング用のWikiErrorクラスとErrorCodes
    - _要件: 2.1, 4.2, 8.4, 8.5_

- [x] 3. AWS認証システムの実装





  - [x] 3.1 Cognito認証サービスの実装


    - AuthServiceクラスの作成
    - ログイン、ログアウト、トークン管理機能の実装
    - ユーザーロール（Guest、Regular、Admin）の管理
    - _要件: 2.1, 2.2, 2.3, 2.5, 5.1_



  - [x] 3.2 認証ストアの実装

    - Svelteストアを使用した認証状態管理
    - トークンの自動リフレッシュ機能
    - 権限チェック機能の実装

    - _要件: 2.3, 2.4, 2.5_

  - [x] 3.3 ログインコンポーネントの作成

    - ログインフォームUI
    - 認証エラーハンドリング
    - ゲストアクセス制御の実装
    - _要件: 2.1, 6.2, 6.3_

- [x] 4. S3ストレージサービスの実装





  - [x] 4.1 基本S3サービスの実装


    - S3Serviceクラスの作成
    - バケット接続とCORS設定の確認
    - 基本的なファイル操作（読み取り、書き込み、削除）
    - _要件: 4.2, 4.5_

  - [x] 4.2 楽観的ロック機能の実装


    - ETagを使用した競合検出
    - SaveResultインターフェースの実装
    - メタデータ更新の原子性保証
    - _要件: 9.1, 9.5_

  - [x] 4.3 エラーハンドリングとリトライ機能


    - WikiErrorクラスとErrorCodesの実装
    - ネットワークエラーのリトライ機能
    - 権限エラーの詳細メッセージ表示
    - _要件: 8.4, 8.5_

- [x] 5. Wikiページ管理システムの実装





  - [x] 5.1 WikiServiceの実装


    - ページのCRUD操作
    - 階層構造の管理
    - ページメタデータの管理
    - _要件: 1.3, 3.1, 3.2_

  - [x] 5.2 ページ検索機能の実装


    - タイトルとコンテンツによる検索
    - 階層構造を考慮した検索結果表示
    - _要件: 3.4_

  - [x] 5.3 ページ削除と孤立ファイル管理


    - PageDeletionResultの実装
    - 孤立ファイルの検出機能
    - 削除確認ダイアログの実装
    - _要件: 7.7, 7.8_

- [x] 6. Milkdownエディタの統合




  - [x] 6.1 Milkdownエディタコンポーネントの作成


    - 基本的なMarkdownエディタの実装
    - リアルタイムプレビュー機能
    - 標準Markdown構文のサポート
    - _要件: 1.1, 1.2, 1.4_

  - [x] 6.2 ページ編集機能の実装


    - 既存ページの読み込み
    - 保存機能とメタデータ更新
    - 編集競合の検出と警告表示
    - _要件: 1.5, 9.2, 9.3_

  - [x] 6.3 競合解決機能の実装


    - 競合比較表示UI
    - 手動マージ機能
    - 競合解決後の保存処理
    - _要件: 9.3, 9.4_

- [x] 7. ファイル管理システムの実装





  - [x] 7.1 FileServiceの実装


    - ファイルアップロード機能
    - ファイル一覧取得と管理
    - 画像ファイルの判定機能
    - _要件: 7.1, 7.9_

  - [x] 7.2 ファイル表示機能の実装


    - 画像ファイルのページ内表示
    - 非画像ファイルのダウンロードリンク表示
    - ファイル参照管理システム
    - _要件: 7.2, 7.3, 7.5_

  - [x] 7.3 ファイル削除と参照チェック


    - ファイル参照の追跡機能
    - 削除時の参照ページ一覧表示
    - 孤立ファイルの自動検出
    - _要件: 7.6, 7.8_

- [ ] 8. ページブラウザとナビゲーションの実装
  - [ ] 8.1 階層構造ブラウザの作成
    - フォルダ/サブフォルダ表示
    - ページ一覧の階層表示
    - ページメタデータの表示
    - _要件: 3.1, 3.6_

  - [ ] 8.2 パンくずナビゲーションの実装
    - 階層構造に対応したパンくず表示
    - ナビゲーション機能
    - _要件: 3.5_

  - [ ] 8.3 検索インターフェースの実装
    - 検索ボックスUI
    - 検索結果の表示
    - フィルタリング機能
    - _要件: 3.4_

- [ ] 9. ユーザー管理機能の実装（Admin用）
  - [ ] 9.1 ユーザー管理インターフェースの作成
    - ユーザー一覧表示
    - ユーザー追加/削除機能
    - ロール管理機能
    - _要件: 5.4, 5.5_

  - [ ] 9.2 設定管理機能の実装
    - wiki.json設定ファイルの管理
    - ゲストアクセス設定の動的変更
    - 設定変更の即座反映
    - _要件: 6.1, 6.5_

- [ ] 10. Terraformインフラストラクチャの実装
  - [ ] 10.1 基本AWSリソースの定義
    - S3バケット、Cognito、IAMロールの定義
    - CORS設定とバケットポリシーの構成
    - _要件: 10.1, 10.2, 10.4_

  - [ ] 10.2 Cognitoアイデンティティプールの設定
    - 適切な権限を持つアイデンティティプール
    - ユーザーロールに基づくアクセス制御
    - _要件: 10.3, 10.4_

  - [ ] 10.3 CloudFrontとドメイン設定
    - CloudFrontディストリビューションの作成
    - カスタムドメインとSSL証明書の設定
    - Route53 DNS設定（オプション）
    - _要件: 8.7_

  - [ ] 10.4 ビルド時設定システムの実装
    - 設定ファイルの読み込み機能
    - バケット名とドメイン名の動的設定
    - エラーハンドリングと確認メッセージ
    - _要件: 8.1, 8.2, 8.3, 8.6_

- [ ] 11. SvelteKitルーティングとメインアプリケーションの統合
  - [ ] 11.1 SvelteKitルーティングの設定
    - ページルート（/、/edit、/browse等）の定義
    - 認証ガードの実装
    - 権限ベースのルートアクセス制御
    - _要件: 2.5, 5.2, 5.3_

  - [ ] 11.2 メインレイアウトとナビゲーション
    - アプリケーション全体のレイアウト
    - ナビゲーションメニュー
    - ユーザー状態表示
    - _要件: 3.3_

  - [ ] 11.3 初期化とデータ読み込み
    - アプリケーション起動時の初期化処理
    - 設定とメタデータの読み込み
    - エラー状態の処理
    - _要件: 4.1, 4.4_

- [ ]* 12. テストの実装
  - [ ]* 12.1 単体テストの作成
    - サービスクラスのテスト
    - ユーティリティ関数のテスト
    - バリデーション機能のテスト

  - [ ]* 12.2 統合テストの実装
    - AWS SDK連携のテスト
    - 認証フローのテスト
    - ファイル操作のテスト

  - [ ]* 12.3 E2Eテストの作成
    - ユーザーログインから記事作成までのフロー
    - ファイルアップロードと参照のテスト
    - 権限制御の動作確認

- [ ] 13. ドキュメント作成とGitHub公開準備
  - [ ] 13.0 GitHubリポジトリの自動化設定
    - GitHubリポジトリの自動作成機能の実装
    - リモートリポジトリ設定の自動化
    - 初期コミットとプッシュの自動化
    - _要件: 10.8_

  - [ ] 13.1 包括的なREADME.mdの作成
    - プロジェクト概要とMarkS3の特徴説明
    - 機能一覧とスクリーンショット
    - 前提条件（AWS アカウント、Node.js等）
    - 詳細なインストール手順（ステップバイステップ）
    - 初期設定とAWS設定ガイド
    - 使用方法とサンプル操作
    - 設定ファイルの説明
    - よくある質問（FAQ）
    - トラブルシューティング
    - _要件: 10.3, 10.4, 全般_

  - [ ] 13.2 GitHub公開用ファイルの作成
    - LICENSEファイルの作成（MIT/Apache等）
    - CONTRIBUTING.mdの作成（コントリビューション方法）
    - CODE_OF_CONDUCT.mdの作成
    - SECURITY.mdの作成（セキュリティポリシー）
    - .github/ISSUE_TEMPLATE/の作成（バグ報告、機能要望）
    - .github/PULL_REQUEST_TEMPLATE.mdの作成
    - _要件: 10.3, 10.5, 10.7_

  - [ ] 13.3 技術ドキュメントの作成
    - docs/フォルダの作成
    - API仕様書（docs/api.md）
    - アーキテクチャ図（docs/architecture.md）
    - 開発者ガイド（docs/development.md）
    - 型定義の詳細説明
    - エラーコードとハンドリング方法
    - _要件: 全般_

  - [ ] 13.4 デプロイメントドキュメントの作成
    - docs/deployment.mdの作成
    - Terraform設定の詳細手順
    - AWS権限設定ガイド
    - カスタムドメイン設定方法
    - 本番環境デプロイのベストプラクティス
    - _要件: 8.1, 8.2, 8.3, 11.1_

  - [ ] 13.5 リリース管理とコミュニティ設定
    - GitHubタグを使用したバージョン管理
    - リリースノートのテンプレート作成
    - CHANGELOGの作成
    - コミットメッセージ規約の文書化
    - GitHub Actionsの設定（CI/CD）
    - _要件: 10.5, 10.6_

- [ ] 14. パフォーマンス最適化

  - [ ] 14.1 フロントエンド最適化

    - コード分割の実装
    - 画像の遅延読み込み
    - マークダウンプレビューのデバウンス

  - [ ] 14.2 キャッシュ機能の実装

    - ページ一覧のキャッシュ
    - ファイルのプリフェッチ
    - メモリ管理の最適化